3 
S 0 _ _ -> S _ > _ ^ 0 > 
S 1 _ _ -> S _ > _ ^ 1 > 
S ( _ _ -> S _ > ( > _ ^ 
S ) _ _ -> s1 ) ^ _ < _ ^ 
s1 ) a _ -> s1 ) ^ _ < a > 
s1 ) o _ -> s1 ) ^ _ < o > 
s1 ) ( _ -> S _ > _ ^ _ ^ 
 
S a _ _ -> s1 a ^ _ < _ ^ 
s1 a a _ -> s1 a ^ _ < a > 
s1 a o _ -> s1 a ^ o > _ ^ 
s1 a _ _ -> S _ > a > _ ^ 
s1 a ( _ -> s1 a ^ ( > _ ^ 
 
S o _ _ -> s1 o ^ _ < _ ^ 
s1 o a _ -> s1 o ^ _ < a > 
s1 o o _ -> s1 o ^ _ < o > 
s1 o _ _ -> S _ > o > _ ^ 
s1 o ( _ -> s1 o ^ ( > _ ^ 
 
S _ _ _ -> s2 _ ^ _ < _ ^ 
s2 _ a _ -> s2 _ ^ _ < a > 
s2 _ o _ -> s2 _ ^ _ < o > 
s2 _ _ _ -> s3 _ ^ _ ^ _ < 
s3 _ _ 0 -> s3 _ ^ _ ^ 0 < 
s3 _ _ 1 -> s3 _ ^ _ ^ 1 < 
s3 _ _ o -> s3 _ ^ _ ^ o < 
s3 _ _ a -> s3 _ ^ _ ^ a < 
s3 _ _ _ -> s _ ^ _ ^ _ > 
 
s _ _ 1 -> s 1 > _ ^ _ > 
s _ _ 0 -> s 0 > _ ^ _ > 
 
 
s _ _ o -> s1' _ < _ ^ o ^ 
s1' 1 _ o -> s2' _ < _ ^ o ^ 
s2' 1 _ o -> s 1 > _ ^ _ > 
s2' 0 _ o -> s 1 > _ ^ _ > 
s1' 0 _ o -> s3' _ < _ ^ o ^ 
s3' 1 _ o -> s 1 > _ ^ _ > 
s3' 0 _ o -> s 0 > _ ^ _ > 
 
s _ _ a -> s1' _ < _ ^ a ^ 
s1' 1 _ a -> s2' _ < _ ^ a ^ 
s2' 1 _ a -> s 1 > _ ^ _ > 
s2' 0 _ a -> s 0 > _ ^ _ > 
s1' 0 _ a -> s3' _ < _ ^ a ^ 
s3' 1 _ a -> s 0 > _ ^ _ > 
s3' 0 _ a -> s 0 > _ ^ _ > 
 
s _ _ _ -> AC _ < _ ^ _ ^ 